import"../chunks/Bzak7iHL.js";import"../chunks/iNhxLszY.js";import{J as B,o as D,A as Ne,L as oe,p as qe,n as Ie,ae as _,ap as Ae,G as Se,H as ke,I as ne,K as z,z as j,$ as De,a3 as Re,w as te,N as Me,M as K,a7 as ce,i as Le,az as Fe,aD as le,aE as Ue,O as de,P as xe,aF as Oe,aG as J,y as fe,aH as He,aI as Ke,a1 as Pe,aJ as je,a6 as pe,aK as Ge,Y as Ve,aL as We,aM as Ye,aN as Be,aO as ze,aP as Je,t as Qe,e as Xe,R as Ze,aQ as $e,a9 as ve,aA as H,aq as _e,ah as U,aj as F,al as O,ak as R,ai as p,F as M,aa as he,ar as o,u as se,C as et,D as tt}from"../chunks/B2Glw-ra.js";import{d as me,s as Q,e as be}from"../chunks/9tIc4D_R.js";import{i as G,b as at}from"../chunks/Dyf42WhF.js";function rt(e,a,t){for(var r=e.items,n=[],l=a.length,u=0;u<l;u++)je(a[u].e,n,!0);var c=l>0&&n.length===0&&t!==null;if(c){var g=t.parentNode;pe(g),g.append(t),r.clear(),L(e,a[0].prev,a[l-1].next)}Ge(n,()=>{for(var E=0;E<l;E++){var q=a[E];c||(r.delete(q.k),L(e,q.prev,q.next)),fe(q.e,!c)}})}function nt(e,a,t,r,n,l=null){var u=e,c={flags:a,items:new Map,first:null};{var g=e;u=D?B(Ne(g)):g.appendChild(oe())}D&&qe();var E=null,q=!1,k=new Map,d=Ae(()=>{var m=t();return Le(m)?m:m==null?[]:ce(m)}),y,f;function h(){lt(f,y,c,k,u,n,a,r,t),l!==null&&(y.length===0?E?de(E):E=te(()=>l(u)):E!==null&&xe(E,()=>{E=null}))}Ie(()=>{f??(f=Ve),y=_(d);var m=y.length;if(q&&m===0)return;q=m===0;let I=!1;if(D){var A=Se(u)===ke;A!==(m===0)&&(u=ne(),B(u),z(!1),I=!0)}if(D){for(var b=null,T,s=0;s<m;s++){if(j.nodeType===De&&j.data===Re){u=j,I=!0,z(!1);break}var w=y[s],N=r(w,s);T=ae(j,c,b,null,w,N,s,n,a,t),c.items.set(N,T),b=T}m>0&&B(ne())}if(D)m===0&&l&&(E=te(()=>l(u)));else if(Me()){var v=new Set,i=K;for(s=0;s<m;s+=1){w=y[s],N=r(w,s);var C=c.items.get(N)??k.get(N);C?we(C,w,s):(T=ae(null,c,null,null,w,N,s,n,a,t,!0),k.set(N,T)),v.add(N)}for(const[S,x]of c.items)v.has(S)||i.skipped_effects.add(x.e);i.add_callback(h)}else h();I&&z(!0),_(d)}),D&&(u=j)}function lt(e,a,t,r,n,l,u,c,g){var E=a.length,q=t.items,k=t.first,d=k,y,f=null,h=[],m=[],I,A,b,T;for(T=0;T<E;T+=1){if(I=a[T],A=c(I,T),b=q.get(A),b===void 0){var s=r.get(A);if(s!==void 0){r.delete(A),q.set(A,s);var w=f?f.next:d;L(t,f,s),L(t,s,w),X(s,w,n),f=s}else{var N=d?d.e.nodes_start:n;f=ae(N,t,f,f===null?t.first:f.next,I,A,T,l,u,g)}q.set(A,f),h=[],m=[],d=f.next;continue}if(we(b,I,T),(b.e.f&J)!==0&&de(b.e),b!==d){if(y!==void 0&&y.has(b)){if(h.length<m.length){var v=m[0],i;f=v.prev;var C=h[0],S=h[h.length-1];for(i=0;i<h.length;i+=1)X(h[i],v,n);for(i=0;i<m.length;i+=1)y.delete(m[i]);L(t,C.prev,S.next),L(t,f,C),L(t,S,v),d=v,f=S,T-=1,h=[],m=[]}else y.delete(b),X(b,d,n),L(t,b.prev,b.next),L(t,b,f===null?t.first:f.next),L(t,f,b),f=b;continue}for(h=[],m=[];d!==null&&d.k!==A;)(d.e.f&J)===0&&(y??(y=new Set)).add(d),m.push(d),d=d.next;if(d===null)continue;b=d}h.push(b),f=b,d=b.next}if(d!==null||y!==void 0){for(var x=y===void 0?[]:ce(y);d!==null;)(d.e.f&J)===0&&x.push(d),d=d.next;var Y=x.length;if(Y>0){var Ce=E===0?n:null;rt(t,x,Ce)}}e.first=t.first&&t.first.e,e.last=f&&f.e;for(var Te of r.values())fe(Te.e);r.clear()}function we(e,a,t,r){Ue(e.v,a),e.i=t}function ae(e,a,t,r,n,l,u,c,g,E,q){var k=(g&He)!==0,d=(g&Ke)===0,y=k?d?Fe(n,!1,!1):le(n):n,f=(g&Oe)===0?u:le(u),h={i:f,v:y,k:l,a:null,e:null,prev:t,next:r};try{if(e===null){var m=document.createDocumentFragment();m.append(e=oe())}return h.e=te(()=>c(e,y,f,E),D),h.e.prev=t&&t.e,h.e.next=r&&r.e,t===null?q||(a.first=h):(t.next=h,t.e.next=h.e),r!==null&&(r.prev=h,r.e.prev=h.e),h}finally{}}function X(e,a,t){for(var r=e.next?e.next.e.nodes_start:t,n=a?a.e.nodes_start:t,l=e.e.nodes_start;l!==null&&l!==r;){var u=Pe(l);n.before(l),l=u}}function L(e,a,t){a===null?e.first=t:(a.next=t,a.e.next=t&&t.e),t!==null&&(t.prev=a,t.e.prev=a&&a.e)}const ue=[...` 	
\r\f \v\uFEFF`];function st(e,a,t){var r=""+e;if(t){for(var n in t)if(t[n])r=r?r+" "+n:n;else if(r.length)for(var l=n.length,u=0;(u=r.indexOf(n,u))>=0;){var c=u+l;(u===0||ue.includes(r[u-1]))&&(c===r.length||ue.includes(r[c]))?r=(u===0?"":r.substring(0,u))+r.substring(c+1):u=c}}return r===""?null:r}function ut(e,a,t,r,n,l){var u=e.__className;if(D||u!==t||u===void 0){var c=st(t,r,l);(!D||c!==e.getAttribute("class"))&&(c==null?e.removeAttribute("class"):e.className=c),e.__className=t}else if(l&&n!==l)for(var g in l){var E=!!l[g];(n==null||E!==!!n[g])&&e.classList.toggle(g,E)}return l}const it=Symbol("is custom element"),ot=Symbol("is html");function Ee(e){if(D){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var r=e.value;ie(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var n=e.checked;ie(e,"checked",null),e.checked=n}}};e.__on_r=t,We(t),Ye()}}function ie(e,a,t,r){var n=ct(e);D&&(n[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||n[a]!==(n[a]=t)&&(a==="loading"&&(e[Be]=t),e.removeAttribute(a))}function ct(e){return e.__attributes??(e.__attributes={[it]:e.nodeName.includes("-"),[ot]:e.namespaceURI===ze})}function ye(e,a,t=a){var r=new WeakSet;Je(e,"input",async n=>{var l=n?e.defaultValue:e.value;if(l=Z(e)?$(l):l,t(l),K!==null&&r.add(K),await Qe(),l!==(l=a())){var u=e.selectionStart,c=e.selectionEnd;e.value=l??"",c!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(c,e.value.length))}}),(D&&e.defaultValue!==e.value||Xe(a)==null&&e.value)&&(t(Z(e)?$(e.value):e.value),K!==null&&r.add(K)),Ze(()=>{var n=a();if(e===document.activeElement){var l=$e??K;if(r.has(l))return}Z(e)&&n===$(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function Z(e){var a=e.type;return a==="number"||a==="range"}function $(e){return e===""?null:+e}async function V(e,a={},t){return window.__TAURI_INTERNALS__.invoke(e,a,t)}class W{constructor(a){this.path=a}static async load(a){const t=await V("plugin:sql|load",{db:a});return new W(t)}static get(a){return new W(a)}async execute(a,t){const[r,n]=await V("plugin:sql|execute",{db:this.path,query:a,values:t??[]});return{lastInsertId:n,rowsAffected:r}}async select(a,t){return await V("plugin:sql|select",{db:this.path,query:a,values:t??[]})}async close(a){return await V("plugin:sql|close",{db:a})}}let ee=null;async function P(){return ee||(ee=await W.load("sqlite:counters.db")),ee}async function dt(){return await(await P()).select("SELECT * FROM counters ORDER BY created_at DESC")}async function re(e){const t=await(await P()).select("SELECT * FROM counters WHERE id = ?",[e]);return t.length>0?t[0]:null}async function ft(e){const t=await(await P()).execute("INSERT INTO counters (name, value) VALUES (?, ?) RETURNING *",[e.name,e.value??0]);if(!t.lastInsertId)throw new Error("Failed to create counter - no ID returned");const r=await re(t.lastInsertId);if(!r)throw new Error("Failed to create counter");return r}async function vt(e){const a=await P(),t=[],r=[];e.name!==void 0&&(t.push("name = ?"),r.push(e.name)),e.value!==void 0&&(t.push("value = ?"),r.push(e.value)),t.push("updated_at = CURRENT_TIMESTAMP"),r.push(e.id),await a.execute(`UPDATE counters SET ${t.join(", ")} WHERE id = ?`,r);const n=await re(e.id);if(!n)throw new Error("Failed to update counter");return n}async function _t(e){await(await P()).execute("DELETE FROM counters WHERE id = ?",[e])}async function ge(e,a=1){await(await P()).execute("UPDATE counters SET value = value + ?, updated_at = CURRENT_TIMESTAMP WHERE id = ?",[a,e]);const r=await re(e);if(!r)throw new Error("Failed to increment counter");return r}async function ht(e,a,t){var r;if(!_(a)){o(a,!0);try{const n=await ge(t.counter.id,1);(r=t.onUpdate)==null||r.call(t,n)}catch(n){console.error("Failed to increment counter:",n)}finally{o(a,!1)}}}async function mt(e,a,t){var r;if(!_(a)){o(a,!0);try{const n=await ge(t.counter.id,-1);(r=t.onUpdate)==null||r.call(t,n)}catch(n){console.error("Failed to decrement counter:",n)}finally{o(a,!1)}}}function bt(e,a,t,r){o(a,!0),o(t,r.counter.name,!0)}function wt(e,a,t){e.key==="Enter"?a():e.key==="Escape"&&t()}function Et(e,a){o(a,!0)}async function yt(e,a,t,r){var n;o(a,!1),o(t,!0);try{await _t(r.counter.id),(n=r.onDelete)==null||n.call(r,r.counter.id)}catch(l){console.error("Failed to delete counter:",l)}finally{o(t,!1)}}function gt(e,a){o(a,!1)}var Ct=U('<input class="counter-name-input svelte-1q155vh" type="text"/>'),Tt=U('<button class="counter-name svelte-1q155vh" title="Click to edit name"> </button>'),Nt=U('<div class="delete-confirm svelte-1q155vh"><button class="confirm-button confirm-yes svelte-1q155vh" title="Confirm delete">✓</button> <button class="confirm-button confirm-no svelte-1q155vh" title="Cancel delete">×</button></div>'),qt=U('<button class="delete-button svelte-1q155vh" title="Delete counter">×</button>'),It=U('<div><div class="counter-header svelte-1q155vh"><!> <!></div> <div class="counter-value svelte-1q155vh"> </div> <div class="counter-controls svelte-1q155vh"><button class="counter-button decrement svelte-1q155vh" title="Decrease by 1">−</button> <button class="counter-button increment svelte-1q155vh" title="Increase by 1">+</button></div> <div class="counter-meta svelte-1q155vh"> </div></div>');function At(e,a){ve(a,!0);let t=H(!1),r=H(_e(a.counter.name)),n=H(!1);async function l(){var v;if(_(r).trim()===a.counter.name||!_(r).trim()){o(t,!1),o(r,a.counter.name,!0);return}o(n,!0);try{const i=await vt({id:a.counter.id,name:_(r).trim()});(v=a.onUpdate)==null||v.call(a,i),o(t,!1)}catch(i){console.error("Failed to update counter name:",i),o(r,a.counter.name,!0),o(t,!1)}finally{o(n,!1)}}function u(){o(t,!1),o(r,a.counter.name,!0)}let c=H(!1);var g=It();let E;var q=F(g),k=F(q);{var d=v=>{var i=Ct();Ee(i),i.__keydown=[wt,l,u],be("blur",i,l),ye(i,()=>_(r),C=>o(r,C)),M(v,i)},y=v=>{var i=Tt();i.__click=[bt,t,r,a];var C=F(i,!0);R(i),p(()=>Q(C,a.counter.name)),M(v,i)};G(k,v=>{_(t)?v(d):v(y,!1)})}var f=O(k,2);{var h=v=>{var i=Nt(),C=F(i);C.__click=[yt,c,n,a];var S=O(C,2);S.__click=[gt,c],R(i),p(()=>{C.disabled=_(n),S.disabled=_(n)}),M(v,i)},m=v=>{var i=qt();i.__click=[Et,c],p(()=>i.disabled=_(n)),M(v,i)};G(f,v=>{_(c)?v(h):v(m,!1)})}R(q);var I=O(q,2),A=F(I,!0);R(I);var b=O(I,2),T=F(b);T.__click=[mt,n,a];var s=O(T,2);s.__click=[ht,n,a],R(b);var w=O(b,2),N=F(w);R(w),R(g),p((v,i,C)=>{E=ut(g,1,"counter svelte-1q155vh",null,E,v),Q(A,i),T.disabled=_(n),s.disabled=_(n),Q(N,`Updated ${C??""}`)},[()=>({loading:_(n)}),()=>a.counter.value.toLocaleString(),()=>new Date(a.counter.updated_at).toLocaleDateString()]),M(e,g),he()}me(["keydown","click"]);function St(e,a,t){e.key==="Enter"?a():e.key==="Escape"&&t()}var kt=(e,a)=>o(a,!0),Dt=U('<div class="new-counter-form svelte-b7qnja"><input class="new-counter-input svelte-b7qnja" type="text" placeholder="Counter name..."/></div>'),Rt=U('<div class="loading svelte-b7qnja">Loading counters...</div>'),Mt=U('<div class="empty-state svelte-b7qnja"><p class="empty-message svelte-b7qnja">No counters yet</p> <p class="empty-hint svelte-b7qnja">Click "New Counter" to create your first one</p></div>'),Lt=U('<div class="counters-grid svelte-b7qnja"></div>'),Ft=U('<div class="counter-list svelte-b7qnja"><header class="header svelte-b7qnja" data-tauri-drag-region=""><h1 class="app-title svelte-b7qnja" data-tauri-drag-region="">count</h1> <button class="add-button svelte-b7qnja" data-tauri-drag-region="false">+ new</button></header> <!> <!></div>');function Ut(e,a){ve(a,!0);let t=H(_e([])),r=H(!1),n=H(!1),l=H(""),u;async function c(){o(r,!0);try{o(t,await dt(),!0)}catch(s){console.error("Failed to load counters:",s)}finally{o(r,!1)}}async function g(){if(_(l).trim()){o(r,!0);try{const s=await ft({name:_(l).trim()});o(t,[s,..._(t)],!0),o(l,""),o(n,!1)}catch(s){console.error("Failed to create counter:",s)}finally{o(r,!1)}}}function E(s){o(t,_(t).map(w=>w.id===s.id?s:w),!0)}function q(s){o(t,_(t).filter(w=>w.id!==s),!0)}function k(){o(n,!1),o(l,"")}function d(s){(s.metaKey||s.ctrlKey)&&s.key==="n"&&(s.preventDefault(),!_(n)&&!_(r)&&(o(n,!0),setTimeout(()=>{u==null||u.focus()},0)))}se(()=>{c()}),se(()=>(document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)));var y=Ft(),f=F(y),h=O(F(f),2);h.__click=[kt,n],R(f);var m=O(f,2);{var I=s=>{var w=Dt(),N=F(w);Ee(N),N.__keydown=[St,g,k],at(N,v=>u=v,()=>u),R(w),be("blur",N,k),ye(N,()=>_(l),v=>o(l,v)),M(s,w)};G(m,s=>{_(n)&&s(I)})}var A=O(m,2);{var b=s=>{var w=Rt();M(s,w)},T=s=>{var w=et(),N=tt(w);{var v=C=>{var S=Mt();M(C,S)},i=C=>{var S=Lt();nt(S,21,()=>_(t),x=>x.id,(x,Y)=>{At(x,{get counter(){return _(Y)},onUpdate:E,onDelete:q})}),R(S),M(C,S)};G(N,C=>{_(t).length===0?C(v):C(i,!1)},!0)}M(s,w)};G(A,s=>{_(r)&&_(t).length===0?s(b):s(T,!1)})}R(y),p(()=>h.disabled=_(r)||_(n)),M(e,y),he()}me(["click","keydown"]);function jt(e){Ut(e,{})}export{jt as component};
